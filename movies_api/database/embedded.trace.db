2022-09-08 18:09:19 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "select * from movie A INNER JOIN MOVIE PRODUCER [*]B ON A.ID=B.IDMOVIE where A.winner=true"; SQL statement:
select * from movie A INNER JOIN MOVIE PRODUCER B ON A.ID=B.IDMOVIE where A.winner=true [42000-214]
2022-09-08 18:09:28 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "select * from movie A INNER JOIN MOVIE PRODUCER [*]B ON A.ID=B.IDMOVIE"; SQL statement:
select * from movie A INNER JOIN MOVIE PRODUCER B ON A.ID=B.IDMOVIE [42000-214]
2022-09-08 18:21:25 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "select * from movie A LEFT JOIN MOVIEPRODUCER B ON A.ID=B.IDMOVIE WHERE A.WINNER=TRUE AND[*]"; expected "INTERSECTS (, NOT, EXISTS, UNIQUE, INTERSECTS"; SQL statement:
select * from movie A LEFT JOIN MOVIEPRODUCER B ON A.ID=B.IDMOVIE WHERE A.WINNER=TRUE AND [42001-214]
2022-09-08 18:22:28 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "[*]WHERE A.WINNER=TRUE"; SQL statement:
WHERE A.WINNER=TRUE [42000-214]
2022-09-08 18:33:40 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "MOVIE_PRODUCER.IDMOVIE" must be in the GROUP BY list; SQL statement:
select * from 
(
select a.name,a.id as idproducer, b.idmovie from producer a left join movieproducer b on a.id = b.idproducer
) as movie_producer inner join movie a on a.id=movie_producer.idmovie where a.winner=true group by idproducer [90016-214]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:632)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:477)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.updateAggregate(ExpressionColumn.java:266)
	at org.h2.command.query.Select.updateAgg(Select.java:539)
	at org.h2.command.query.Select.gatherGroup(Select.java:522)
	at org.h2.command.query.Select.queryGroup(Select.java:488)
	at org.h2.command.query.Select.queryWithoutCache(Select.java:828)
	at org.h2.command.query.Query.queryWithoutCacheLazyCheck(Query.java:197)
	at org.h2.command.query.Query.query(Query.java:512)
	at org.h2.command.query.Query.query(Query.java:475)
	at org.h2.command.CommandContainer.query(CommandContainer.java:251)
	at org.h2.command.Command.executeQuery(Command.java:190)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:247)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:223)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1339)
	at org.h2.server.web.WebApp.query(WebApp.java:1137)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1103)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1090)
	at org.h2.server.web.WebThread.process(WebThread.java:188)
	at org.h2.server.web.WebThread.run(WebThread.java:101)
	at java.lang.Thread.run(Thread.java:750)
2022-09-08 18:36:54 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "B.IDMOVIE" must be in the GROUP BY list; SQL statement:
select * from 
(
    select a.name,a.id as idproducer, b.idmovie from producer a left join movieproducer b on a.id = b.idproducer group by idproducer
) as movie_producer inner join movie a on a.id=movie_producer.idmovie where a.winner=true [90016-214]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:632)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:477)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.updateAggregate(ExpressionColumn.java:266)
	at org.h2.command.query.Select.updateAgg(Select.java:539)
	at org.h2.command.query.Select$LazyResultGroupSorted.fetchNextRow(Select.java:1919)
	at org.h2.result.LazyResult.hasNext(LazyResult.java:78)
	at org.h2.result.FetchedResult.next(FetchedResult.java:34)
	at org.h2.command.query.Select.queryGroupSorted(Select.java:320)
	at org.h2.command.query.Select.queryWithoutCache(Select.java:826)
	at org.h2.command.query.Query.queryWithoutCacheLazyCheck(Query.java:197)
	at org.h2.command.query.Query.query(Query.java:512)
	at org.h2.command.query.Query.query(Query.java:475)
	at org.h2.index.QueryExpressionIndex.find(QueryExpressionIndex.java:269)
	at org.h2.index.QueryExpressionIndex.find(QueryExpressionIndex.java:152)
	at org.h2.index.IndexCursor.find(IndexCursor.java:161)
	at org.h2.table.TableFilter.next(TableFilter.java:394)
	at org.h2.command.query.Select$LazyResultQueryFlat.fetchNextRow(Select.java:1832)
	at org.h2.result.LazyResult.hasNext(LazyResult.java:78)
	at org.h2.result.FetchedResult.next(FetchedResult.java:34)
	at org.h2.command.query.Select.queryFlat(Select.java:728)
	at org.h2.command.query.Select.queryWithoutCache(Select.java:833)
	at org.h2.command.query.Query.queryWithoutCacheLazyCheck(Query.java:197)
	at org.h2.command.query.Query.query(Query.java:512)
	at org.h2.command.query.Query.query(Query.java:475)
	at org.h2.command.CommandContainer.query(CommandContainer.java:251)
	at org.h2.command.Command.executeQuery(Command.java:190)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:247)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:223)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1339)
	at org.h2.server.web.WebApp.query(WebApp.java:1137)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1103)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1090)
	at org.h2.server.web.WebThread.process(WebThread.java:188)
	at org.h2.server.web.WebThread.run(WebThread.java:101)
	at java.lang.Thread.run(Thread.java:750)
2022-09-08 18:37:21 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "B.IDMOVIE" must be in the GROUP BY list; SQL statement:
select * from 
(
    select a.name,a.id as idproducer, b.idmovie from producer a left join movieproducer b on a.id = b.idproducer group by idproducer
) as movie_producer inner join movie a on a.id=movie_producer.idmovie where a.winner=true [90016-214]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:632)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:477)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.updateAggregate(ExpressionColumn.java:266)
	at org.h2.command.query.Select.updateAgg(Select.java:539)
	at org.h2.command.query.Select$LazyResultGroupSorted.fetchNextRow(Select.java:1919)
	at org.h2.result.LazyResult.hasNext(LazyResult.java:78)
	at org.h2.result.FetchedResult.next(FetchedResult.java:34)
	at org.h2.command.query.Select.queryGroupSorted(Select.java:320)
	at org.h2.command.query.Select.queryWithoutCache(Select.java:826)
	at org.h2.command.query.Query.queryWithoutCacheLazyCheck(Query.java:197)
	at org.h2.command.query.Query.query(Query.java:512)
	at org.h2.command.query.Query.query(Query.java:475)
	at org.h2.index.QueryExpressionIndex.find(QueryExpressionIndex.java:269)
	at org.h2.index.QueryExpressionIndex.find(QueryExpressionIndex.java:152)
	at org.h2.index.IndexCursor.find(IndexCursor.java:161)
	at org.h2.table.TableFilter.next(TableFilter.java:394)
	at org.h2.command.query.Select$LazyResultQueryFlat.fetchNextRow(Select.java:1832)
	at org.h2.result.LazyResult.hasNext(LazyResult.java:78)
	at org.h2.result.FetchedResult.next(FetchedResult.java:34)
	at org.h2.command.query.Select.queryFlat(Select.java:728)
	at org.h2.command.query.Select.queryWithoutCache(Select.java:833)
	at org.h2.command.query.Query.queryWithoutCacheLazyCheck(Query.java:197)
	at org.h2.command.query.Query.query(Query.java:512)
	at org.h2.command.query.Query.query(Query.java:475)
	at org.h2.command.CommandContainer.query(CommandContainer.java:251)
	at org.h2.command.Command.executeQuery(Command.java:190)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:247)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:223)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1339)
	at org.h2.server.web.WebApp.query(WebApp.java:1137)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1103)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1090)
	at org.h2.server.web.WebThread.process(WebThread.java:188)
	at org.h2.server.web.WebThread.run(WebThread.java:101)
	at java.lang.Thread.run(Thread.java:750)
2022-09-08 18:46:33 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "select idproducer,release - lag(release) over(partition by idproducer order by release) diff\000d\000a[*](\000d\000a    select * from \000d\000a    (\000d\000a        select a.name,a.id as idproducer, b.idmovie from producer a left join movieproducer b on a.id = b.idproducer\000d\000a    ) as movie_producer inner join movie a on a.id=movie_producer.idmovie where a.winner=true \000d\000a)as data_table"; SQL statement:
select idproducer,release - lag(release) over(partition by idproducer order by release) diff
(
    select * from 
    (
        select a.name,a.id as idproducer, b.idmovie from producer a left join movieproducer b on a.id = b.idproducer
    ) as movie_producer inner join movie a on a.id=movie_producer.idmovie where a.winner=true 
)as data_table [42000-214]
2022-09-08 19:07:01 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "select idproducer,release - lag(release) over(partition by idproducer order by release) diff\000d\000a[*](\000d\000a    select * from \000d\000a    (\000d\000a        select a.name,a.id as idproducer, b.idmovie from producer a left join movieproducer b on a.id = b.idproducer\000d\000a    ) as movie_producer inner join movie a on a.id=movie_producer.idmovie where a.winner=true \000d\000a)as data_table"; SQL statement:
select idproducer,release - lag(release) over(partition by idproducer order by release) diff
(
    select * from 
    (
        select a.name,a.id as idproducer, b.idmovie from producer a left join movieproducer b on a.id = b.idproducer
    ) as movie_producer inner join movie a on a.id=movie_producer.idmovie where a.winner=true 
)as data_table [42000-214]
2022-09-08 19:13:23 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Column "DIFF" not found; SQL statement:
select *,release - lag(release) over(partition by idproducer order by release) diff from
(
    select * from 
    (
        select a.name,a.id as idproducer, b.idmovie from producer a left join movieproducer b on a.id = b.idproducer
    ) as movie_producer inner join movie a on a.id=movie_producer.idmovie where a.winner=true 
)as data_table where diff!=null [42122-214]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:502)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:477)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.expression.ExpressionColumn.getColumnException(ExpressionColumn.java:244)
	at org.h2.expression.ExpressionColumn.optimizeOther(ExpressionColumn.java:226)
	at org.h2.expression.ExpressionColumn.optimize(ExpressionColumn.java:213)
	at org.h2.expression.condition.Comparison.optimize(Comparison.java:139)
	at org.h2.expression.Expression.optimizeCondition(Expression.java:148)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1177)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:575)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:631)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:554)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1116)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:237)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:223)
	at org.h2.server.web.WebApp.getResult(WebApp.java:1339)
	at org.h2.server.web.WebApp.query(WebApp.java:1137)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1103)
	at org.h2.server.web.WebApp$1.next(WebApp.java:1090)
	at org.h2.server.web.WebThread.process(WebThread.java:188)
	at org.h2.server.web.WebThread.run(WebThread.java:101)
	at java.lang.Thread.run(Thread.java:750)
2022-09-08 19:14:02 jdbc[3]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement "select *, release - lag(release) over(partition by idproducer order by release) diff [*]as year_winner from\000d\000a(\000d\000a    select * from \000d\000a    (\000d\000a        select a.name,a.id as idproducer, b.idmovie from producer a left join movieproducer b on a.id = b.idproducer\000d\000a    ) as movie_producer inner join movie a on a.id=movie_producer.idmovie where a.winner=true \000d\000a)as data_table"; SQL statement:
select *, release - lag(release) over(partition by idproducer order by release) diff as year_winner from
(
    select * from 
    (
        select a.name,a.id as idproducer, b.idmovie from producer a left join movieproducer b on a.id = b.idproducer
    ) as movie_producer inner join movie a on a.id=movie_producer.idmovie where a.winner=true 
)as data_table [42000-214]
2022-09-09 11:32:20 jdbc[5]: null
org.h2.message.DbException: The connection was not closed by the application and is garbage collected [90018-214]
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.get(DbException.java:188)
	at org.h2.jdbc.JdbcConnection.closeOld(JdbcConnection.java:190)
	at org.h2.jdbc.JdbcConnection.<init>(JdbcConnection.java:132)
	at org.h2.Driver.connect(Driver.java:59)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:247)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.jpype.JPypeContext.callMethod(Unknown Source)
Caused by: org.h2.jdbc.JdbcSQLNonTransientConnectionException: The connection was not closed by the application and is garbage collected [90018-214]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:678)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:477)
	... 13 more
